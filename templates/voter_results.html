<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" type="image/svg+xml" href="/static/uploads/votecentral-icon.svg">

<meta charset="UTF-8" />
<title>VoteCentral | Election Results</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
/* --- SAME TOKENS & STYLES (unchanged) --- */
:root{
  --bg:#020617;--panel:#0f172a;--border:rgba(148,163,184,.15);
  --blue:#38bdf8;--indigo:#6366f1;--green:#10b981;
  --red:#ef4444;--yellow:#facc15;--text:#f8fafc;
  --muted:#94a3b8;--radius-xl:24px;--radius-lg:18px;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Plus Jakarta Sans',sans-serif;}
body{background:radial-gradient(at 0% 0%,rgba(56,189,248,.08),transparent 50%),
radial-gradient(at 100% 0%,rgba(99,102,241,.08),transparent 50%),var(--bg);color:var(--text);}
.header{position:sticky;top:0;z-index:1000;background:rgba(2,6,23,.88);
backdrop-filter:blur(14px);border-bottom:1px solid var(--border);padding:14px 18px;}
.header-inner{max-width:1200px;margin:auto;display:flex;justify-content:space-between;align-items:center;}
.brand h2{font-size:1.1rem;font-weight:800;} .brand span{color:var(--blue);}
.back-btn{background:rgba(56,189,248,.15);border:1px solid rgba(56,189,248,.35);
color:var(--blue);padding:8px 16px;border-radius:12px;font-weight:700;text-decoration:none;}
.container{max-width:1200px;margin:auto;padding:24px 18px 120px;}
.glass-card{background:var(--panel);border:1px solid var(--border);
border-radius:var(--radius-xl);padding:24px;box-shadow:0 20px 50px rgba(0,0,0,.35);margin-bottom:20px;}
.filter-grid{display:grid;grid-template-columns:2fr 1fr 1fr;gap:12px;margin-top:16px;}
@media(max-width:600px){.filter-grid{grid-template-columns:1fr;}}
input,select{width:100%;padding:14px;border-radius:14px;background:var(--bg);
border:1px solid var(--border);color:var(--text);}

/* TABLE */
.table{width:100%;border-collapse:collapse;}
.table th,.table td{border:1px solid var(--border);padding:12px;text-align:center;}
.table th{background:#020617;font-weight:800;}
.badge{padding:6px 10px;border-radius:999px;font-size:11px;font-weight:800;}
.badge-public{background:rgba(16,185,129,.18);color:#34d399;}
.badge-private{background:rgba(99,102,241,.18);color:#818cf8;}
.ok{color:var(--green);font-weight:800;}
.warn{color:var(--yellow);font-weight:800;}
.block{color:var(--red);font-weight:800;}
.btn{padding:8px 14px;border-radius:12px;border:none;font-weight:800;}
.btn-blue{background:linear-gradient(135deg,var(--blue),var(--indigo));color:#020617;}
.btn-gray{background:#1e293b;color:var(--muted);}

/* MOBILE */
.mobile-results{display:none;}
@media(max-width:700px){
.table-wrap{display:none;}
.mobile-results{display:grid;gap:16px;}
.result-card{background:linear-gradient(180deg,#0f172a,#020617);
border:1px solid var(--border);border-radius:22px;padding:18px;}
.result-card.available{box-shadow:0 0 0 1px rgba(16,185,129,.25);}
.status-pill{display:inline-block;padding:6px 14px;border-radius:999px;font-size:.7rem;font-weight:800;margin-bottom:10px;}
.status-ok{background:rgba(16,185,129,.15);color:var(--green);}
.status-warn{background:rgba(250,204,21,.15);color:var(--yellow);}
.status-block{background:rgba(239,68,68,.15);color:var(--red);}
.result-meta{font-size:.75rem;color:var(--muted);margin-bottom:12px;}
.card-footer{display:flex;gap:12px;}
.card-footer .btn{flex:1;padding:12px;}
}
.no-results{text-align:center;color:var(--muted);padding:30px;font-weight:700;}
/* ================= DESKTOP TABLE PREMIUM STYLE ================= */

/* Column sizing */
.table th:nth-child(1),
.table td:nth-child(1){ width:36%; }

.table th:nth-child(2),
.table td:nth-child(2){ width:14%; }

.table th:nth-child(3),
.table td:nth-child(3){ width:12%; }

.table th:nth-child(4),
.table td:nth-child(4){ width:18%; }

.table th:nth-child(5),
.table td:nth-child(5){ width:20%; }

/* Zebra rows */
.table tbody tr:nth-child(even){
  background:rgba(148,163,184,.03);
}

/* Hover highlight */
.table tbody tr:hover{
  background:rgba(56,189,248,.06);
}

/* Election column */
.col-election{
  text-align:left;
  padding-left:18px;
}

.election-name{
  font-weight:800;
  font-size:.95rem;
  line-height:1.35;
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  align-items:center;
}

.election-code{
  font-size:.75rem;
  font-weight:700;
  color:var(--muted);
  letter-spacing:.3px;
}

/* Center non-text columns neatly */
.table td:not(.col-election){
  vertical-align:middle;
}

/* Status column refinement */
.table td:nth-child(4){
  font-weight:800;
  letter-spacing:.3px;
}

/* Action buttons alignment */
.table td:last-child{
  text-align:center;
}

/* Header refinement */
.table thead th{
  text-transform:uppercase;
  font-size:.7rem;
  letter-spacing:1px;
  color:var(--muted);
}

/* No-results row */
.no-results{
  font-size:.9rem;
  letter-spacing:.3px;
}
.back-btn{
  display:flex;
  align-items:center;
  gap:4px;
  background:rgba(56,189,248,.15);
  border:1px solid rgba(56,189,248,.35);
  color:var(--blue);
  padding:8px 10px;
  border-radius:12px;
  font-weight:700;
  text-decoration:none;
  transition:background .2s ease;
}

.back-btn svg{
  width:14px;
  height:14px;
}

.back-btn:hover{
  background:rgba(56,189,248,.25);
}
.section-subtitle{
  font-size:.85rem;
  color:var(--muted);
  margin-top:4px;
  margin-bottom:12px;
}
@media (prefers-reduced-motion: reduce){
  *{
    animation:none !important;
    transition:none !important;
  }
}
.result-card{
  transition:transform .2s ease, box-shadow .2s ease;
}

.result-card:hover{
  transform:translateY(-3px);
  box-shadow:0 12px 30px rgba(0,0,0,.4);
}

/* ================= EMPTY STATE ================= */

.empty-state-card{
  text-align:center;
  padding:60px 40px;
  margin-top:30px;
  background:linear-gradient(
    180deg,
    rgba(15,23,42,.9),
    rgba(2,6,23,.9)
  );
  border:1px solid var(--border);
  border-radius:var(--radius-xl);
  box-shadow:0 20px 50px rgba(0,0,0,.35);
}

.empty-icon{
  width:90px;
  height:90px;
  margin:0 auto 20px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  background:linear-gradient(135deg,var(--blue),var(--indigo));
  color:#020617;
  box-shadow:0 20px 50px rgba(56,189,248,.25);
}

.empty-state-card h2{
  font-size:1.6rem;
  font-weight:800;
  margin-bottom:12px;
}

.empty-state-card p{
  font-size:.95rem;
  color:var(--muted);
  margin-bottom:8px;
  max-width:520px;
  margin-left:auto;
  margin-right:auto;
}

.empty-meta{
  font-size:.8rem;
  color:var(--muted);
  opacity:.75;
}
.empty-state-card{
  animation:fadeInUp .3s ease-out;
}

@keyframes fadeInUp{
  from{
    opacity:0;
    transform:translateY(10px);
  }
  to{
    opacity:1;
    transform:translateY(0);
  }
}

</style>
</head>

<body>

<header class="header">
  <div class="header-inner">
    
    <div class="brand"><img src="/static/uploads/votecentral-logo.svg" style="height: 35px;margin-left: -3px;margin-bottom: -10px;">
</div>
    <a href="/voter/dashboard" class="back-btn" aria-label="Return to dashboard">
  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <line x1="19" y1="12" x2="5" y2="12"/>
    <polyline points="12 19 5 12 12 5"/>
  </svg>
  Dashboard
</a>

  </div>
</header>

<div class="container">

<div class="glass-card">
  <h3>Election Results</h3>
  <p class="section-subtitle">
  Review results for concluded elections.
</p>
  <div class="filter-grid">
    <input id="searchBox" placeholder="Search election name or code">
    <select id="filterType">
      <option value="">All Types</option>
      <option value="public">Public</option>
      <option value="private">Private</option>
    </select>
    <select id="filterStatus">
      <option value="">All Status</option>
      <option value="available">Available</option>
      <option value="running">Running</option>
      <option value="upcoming">Not Started</option>
      <option value="hidden">Hidden</option>
      <option value="restricted">Restricted</option>
    </select>
  </div>
</div>
{% if elections|length == 0 %}
<div class="glass-card empty-state-card">
  <div class="empty-icon">
    <svg viewBox="-3 -2 30 30" fill="none" stroke="currentColor" stroke-width="1.6">
      <rect x="3" y="4" width="18" height="18" rx="3"/>
      <path d="M8 10h8M8 14h5"/>
    </svg>
  </div>

  <h2>No Results Found</h2>
<p>
  There are currently no elections with results available for viewing.
</p>
<div class="empty-meta">
  Results will appear once elections conclude and are published by administrators.
</div>

</div>
{% else %}

<!-- DESKTOP TABLE -->
<div class="glass-card table-wrap">
<table class="table">
<thead>
<tr>
  <th>Election</th><th>Type</th><th>Total Votes</th><th>Status</th><th>Action</th>
</tr>
</thead>
<tbody id="desktopBody">

{% for e in elections %}
<tr class="result-row"
 data-name="{{ e.name|lower }} {{ e.public_code|lower if e.type=='public' else '' }}"
 data-type="{{ e.type }}"
 data-status="{% if e.upcoming %}upcoming{% elif e.running %}running{% elif e.ended and e.can_view %}available{% elif e.ended and not e.visible %}hidden{% else %}restricted{% endif %}">
<td class="col-election">
  <div class="election-name">
    {{ e.name }}
    {% if e.type=='public' and e.public_code %}
      <span class="election-code">({{ e.public_code }})</span>
    {% endif %}
  </div>
</td>

<td><span class="badge {{ 'badge-public' if e.type=='public' else 'badge-private' }}">{{ e.type|upper }}</span></td>
<td>{{ e.total_votes }}</td>
<td>
{% if e.ended and e.can_view %}<span class="ok">Available</span>
{% elif e.running %}<span class="warn">Running</span>
{% else %}<span class="block">Restricted</span>{% endif %}
</td>
<td>
{% if e.ended and e.can_view %}
<a href="/voter/results/{{ e.id }}"><button class="btn btn-blue">Open</button></a>
{% else %}
<button class="btn btn-gray" disabled>Unavailable</button>
{% endif %}
</td>
</tr>
{% endfor %}


</tbody>
</table>
</div>
<div id="noResultsCardDesktop"
     class="empty-state-card"
     style="display:none">

  <div class="empty-icon">
    <svg width="42" height="42" viewBox="0 0 24 24"
         fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="11" cy="11" r="8"/>
      <line x1="21" y1="21" x2="16.65" y2="16.65"/>
    </svg>
  </div>

  <h2>No Matching Election Results</h2>

  <p>
    No results match your current filters.
  </p>

  <div class="empty-meta">
    Adjust filters or refine your search criteria.
  </div>
</div>

<!-- MOBILE -->
<div class="mobile-results" id="mobileResults">
{% for e in elections %}
<div class="result-card result-row {% if e.ended and e.can_view %}available{% endif %}"
 data-name="{{ e.name|lower }} {{ e.public_code|lower if e.type=='public' else '' }}"
 data-type="{{ e.type }}"
 data-status="{% if e.upcoming %}upcoming{% elif e.running %}running{% elif e.ended and e.can_view %}available{% elif e.ended and not e.visible %}hidden{% else %}restricted{% endif %}">
<span class="status-pill {{ 'status-ok' if e.ended and e.can_view else 'status-block' }}">
  {{ 'Results Available' if e.ended and e.can_view else 'Access Restricted' }}
</span>
<h4>{{ e.name }}{% if e.type=='public' and e.public_code %} ({{ e.public_code }}){% endif %}</h4>
<div class="result-meta">{{ e.type|upper }} â€¢ {{ e.total_votes }} votes</div>
<div class="card-footer">
{% if e.ended and e.can_view %}
<a href="/voter/results/{{ e.id }}"><button class="btn btn-blue">View</button></a>
{% else %}
<button class="btn btn-gray" disabled>Not Available</button>
{% endif %}
</div>
</div>
{% endfor %}


{% endif %}

</div>

<script>
const PRIORITY={available:1,running:2,upcoming:3,hidden:4,restricted:5};
const rows=[...document.querySelectorAll(".result-row")];
const desktopBody=document.getElementById("desktopBody");
const mobile=document.getElementById("mobileResults");

function reorder(){
  rows.sort((a,b)=>(PRIORITY[a.dataset.status]||9)-(PRIORITY[b.dataset.status]||9))
      .forEach(r=>{
        if(r.closest("tbody")) desktopBody.appendChild(r);
        else mobile.appendChild(r);
      });
}

function applyFilters(){
  const q = searchBox.value.toLowerCase();
  const t = filterType.value;
  const s = filterStatus.value;

  let visible = 0;

  rows.forEach(r=>{
    let show = true;
    if(q && !r.dataset.name.includes(q)) show = false;
    if(t && r.dataset.type !== t) show = false;
    if(s && r.dataset.status !== s) show = false;

    r.style.display = show ? "" : "none";
    if(show) visible++;
  });

  const desktopEmpty = document.getElementById("noResultsCardDesktop");
  const mobileEmpty = document.getElementById("noResultsMobile");
  const tableWrap = document.querySelector(".table-wrap");

  if (visible === 0) {
    if(tableWrap) tableWrap.style.display = "none";
    if(desktopEmpty) desktopEmpty.style.display = "block";
    if(mobileEmpty) mobileEmpty.style.display = "block";
  } else {
    if(tableWrap) tableWrap.style.display = "block";
    if(desktopEmpty) desktopEmpty.style.display = "none";
    if(mobileEmpty) mobileEmpty.style.display = "none";
  }
}

searchBox.oninput=applyFilters;
filterType.onchange=applyFilters;
filterStatus.onchange=applyFilters;

reorder();
</script>

</body>
</html>
